<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>AI</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div>
      <h1>Online AI</h1>
      <form id="ai-form">
        <div class="container">
          <div id="answer">
            <textarea id="userInput" name="userInput" rows="5" cols="50" placeholder="Enter question:"></textarea>
          </div>
        </div>
        <br/>
        <div class="text-box">
          <pre id="response" class="wrapped-text"></pre>
        </div>
    </form>
    </div>
    <script>
      const apiKey = "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"; // Be cautious with API key in public
      const form = document.getElementById("ai-form");
      const textarea = document.getElementById("userInput");
      const responseBox = document.getElementById("response");

      textarea.addEventListener("keydown", function (e) {
        if (e.key === "Enter" && !e.shiftKey) {
          e.preventDefault();
          form.dispatchEvent(new Event("submit"));
        }
      });

      form.addEventListener("submit", async (e) => {
        e.preventDefault();
        const userInput = textarea.value.trim();
        if (!userInput) return;

        responseBox.textContent = "Loading...";

        const response = await fetch(
          "https://api.groq.com/openai/v1/chat/completions",
          {
            method: "POST",
            headers: {
              Authorization: `Bearer ${apiKey}`,
              "Content-Type": "application/json",
            },
            body: JSON.stringify({
              model: "llama-3.3-70b-versatile",
              messages: [
                {
                  role: "system",
                  content: "You are an AI assistant that helps with work and general questions. If text is generally pretty long make sure to add a short summary.",
                },
                { role: "user", content: userInput },
              ],
            }),
          }
        );

        const data = await response.json();
        responseBox.textContent = data.choices[0].message.content;
        textarea.value = ""; // clear input
      });
    </script>
  </body>
</html>
